"use strict";
var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};
var tweetnacl = require('./external/tweetnacl-nacl-fast-keccak');
var _a = require('../CryptoTypes'), PrivateKey = _a.PrivateKey, PublicKey = _a.PublicKey, Signature = _a.Signature;
/**
 * Represents an ED25519 private and public key.
 */
var KeyPair = /** @class */ (function () {
    /**
     * Creates a key pair from a private key.
     * @param {PrivateKey} privateKey Private key.
     */
    function KeyPair(privateKey) {
        this._privateKey = privateKey;
        var reversedPrivateKeyBytes = new Uint8Array(__spreadArray([], privateKey.bytes, true));
        reversedPrivateKeyBytes.reverse();
        this._keyPair = tweetnacl.sign.keyPair.fromSeed(reversedPrivateKeyBytes);
    }
    Object.defineProperty(KeyPair.prototype, "publicKey", {
        /**
         * Gets the public key.
         * @returns {PublicKey} Public key.
         */
        get: function () {
            return new PublicKey(this._keyPair.publicKey);
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(KeyPair.prototype, "privateKey", {
        /**
         * Gets the private key.
         * @returns {PrivateKey} Private key.
         */
        get: function () {
            return new PrivateKey(this._privateKey.bytes);
        },
        enumerable: false,
        configurable: true
    });
    /**
     * Signs a message with the private key.
     * @param {Uint8Array} message Message to sign.
     * @returns {Signature} Message signature.
     */
    KeyPair.prototype.sign = function (message) {
        return new Signature(tweetnacl.sign.detached(message, this._keyPair.secretKey));
    };
    return KeyPair;
}());
/**
 * Verifies signatures signed by a single key pair.
 */
var Verifier = /** @class */ (function () {
    /**
     * Creates a verifier from a public key.
     * @param {PublicKey} publicKey Public key.
     */
    function Verifier(publicKey) {
        this.publicKey = publicKey;
    }
    /**
     * Verifies a message signature.
     * @param {Uint8Array} message Message to verify.
     * @param {Signature} signature Signature to verify.
     * @returns {boolean} true if the message signature verifies.
     */
    Verifier.prototype.verify = function (message, signature) {
        return tweetnacl.sign.detached.verify(message, signature.bytes, this.publicKey.bytes);
    };
    return Verifier;
}());
module.exports = { KeyPair: KeyPair, Verifier: Verifier };
